---
title: "Geometric Morphometrics"
output: html_notebook
---
Read CSV, Load all packages And Configure Analysis
```{r}
# read packages
source('GeneralizedProcrustesAnalysis.R')
```

```{r}
#read csv
df = read.csv("combined_tracings.csv")

#configure surface and species
species = readline(prompt="Will this be a human, macaque, or combined analysis?")
if (species == 'human' || species == 'macaque') {
  df = df[df$gm_or_wm == surface,]
}

surface = readline(prompt="Chose gray matter (pi) or white matter (wh)")
df = df[df$gm_or_wm == surface,]

```

Handle Outliers
```{r}
OUTLIERS = list('18_92months_human', '17_78months_human', '19_9months_human', '24_87months_human', '25_89months_human', '25_1month_macaque', '14_20months_human')
df = excludeOutliers(df, OUTLIERS)
```

Resample Sulci to 100 Points and Run Procrustes Analysis
```{r}
num = as.numeric(readline(prompt="How many landmarks are there?"))

resampled = resampleCurves(df, surface, species)
data = transformToArray(resampled, num)

GPA = procrustes(num, data)
plot3d(GPA$consensus)
```

Resample Sulci again based on Sulcal Length
```{r}
ref = findSulcalLengths(surface, species, GPA$consensus)

resampled = resampleCurves(df, surface, species, sulcalLengths=ref)
num = sumlm(ref)
data = transformToArray(resampled, num)

GPA = procrustes(num, data, sulcalLengths=ref)
plot3d(GPA$consensus)


```

